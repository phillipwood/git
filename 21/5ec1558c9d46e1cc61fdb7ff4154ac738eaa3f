changes since v1:
 - this patch replaces patch 2 in the previous version.
