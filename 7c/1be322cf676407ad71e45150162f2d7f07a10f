It would perhaps be better to pass around the_index rather than
the_repository
