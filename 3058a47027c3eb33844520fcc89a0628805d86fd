changes since v1:
 - prefix cleanup_mode enum and constants with commit_msg_
