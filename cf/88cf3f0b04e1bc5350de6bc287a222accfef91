changes since v4:
 - use a separate if clause to handle with "\ No new line..." lines
   rather than crow-baring them into the "+" line handling.
